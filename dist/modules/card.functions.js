import{$}from"@/core/dom";import{mdb}from"@/services/api.service";import{modalHandler,renderModal}from"@/modules/modal.functions";function renderCard(t){if(t.poster_path){const a=t.vote_average?`<span class="card__rating">${t.vote_average.toFixed(1)}</span>`:"",e=t.title?t.title:t.name;return`\n            <div class="card" data-id="${t.id}">\n\t\t\t\t\t\t\t\t\t<div class="play-btn">\n                \t\t<i class="fab fa-youtube" data-type="play"></i>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<img class="card__img" src="https://image.tmdb.org/t/p/w500${t.poster_path}" alt="${e}" data-type="card">\n\t\t\t\t\t\t\t\t${a}\n\t\t\t\t\t\t\t\t<p class="card__text">${e}</p>\n            </div>\n        `}}export async function cardHandler(t,a){const e=$(t.target);let r;if(e.noClass("container")&&(r=e.closest(".card").data.id),"card"===e.data.type){this.loader.show();const t=await mdb.getFullData(a,r);console.log(t);$(renderModal(t,a)).on("click",modalHandler),this.loader.hide()}"play"===e.data.type&&(this.loader.show(),await mdb.showTrailer("movie",r),this.loader.hide())}export async function createCards(t,a,e){this.loader.show();const r=await mdb.fetchCards(t,a),i=r.results.map(renderCard).join("");this.container.insert(i,"beforeend"),this.pagination.innerHTML=createPagination(r.total_pages,getPage(e),e),this.loader.hide()}export async function switchPages(t,a,e){const r=$(t.target);if(r.hasClass("pagination__link")){const t=r.innerText;this.container.clear(),this.pagination.clear(),createCards.call(this,a,t,e),localStorage.setItem(e,JSON.stringify(t))}}export function getPage(t){return localStorage.getItem(t)?+JSON.parse(localStorage.getItem(t)):1}